# Test Environment Variables Example
# Copy this file to .env.test.local and update with your test database credentials
# For CI, set these in your CI environment secrets

# ============================================================================
# DATABASE CONFIGURATION (REQUIRED)
# ============================================================================

# IMPORTANT: Use a dedicated test database to prevent data loss!
# The database name MUST contain "_test" for safety.
#
# Option 1 (Recommended): Use a separate test database
# DATABASE_URL="postgresql://user:password@host:5432/quarrycrm_test?sslmode=require"
#
# Option 2 (Local Dev Only): Use same database with ALLOW_UNSAFE_TEST_DB=1
# WARNING: This will TRUNCATE all data on each test run!
# DATABASE_URL="postgresql://user:password@host:5432/quarrycrm?sslmode=require"
# ALLOW_UNSAFE_TEST_DB=1
#
# For Neon (Recommended for CI):
# 1. Create a branch named "test" or "ci-test"
# 2. Copy the connection string from Neon dashboard
# 3. Ensure the database name contains "_test"
DATABASE_URL="postgresql://neondb_owner:***@host/neondb_test?sslmode=require"

# ============================================================================
# UNSAFE MODE (Local Dev Only - NOT for CI/Production)
# ============================================================================

# Set to "1" to bypass the test database safety check
# DANGER: This will TRUNCATE your database on each test run!
# Only use this for local development when you don't have a separate test DB
# NEVER use this in CI or production environments
# ALLOW_UNSAFE_TEST_DB=1

# ============================================================================
# OTHER TEST ENVIRONMENT VARIABLES
# ============================================================================

NODE_ENV=test
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=test_secret_key_for_testing_only

# Email (can use fake values for tests)
RESEND_API_KEY=test_key
EMAIL_FROM=test@example.com

# Encryption (use test keys, not production)
ENCRYPTION_KEY=000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f
KMS_KEY_ID=test-key-v1

# Demo/Auth
DEMO_TOKEN_SECRET=test_demo_secret

# ============================================================================
# CI CONFIGURATION NOTES
# ============================================================================

# For GitHub Actions:
# 1. Create secrets in repository settings:
#    - DATABASE_URL (with _test in database name)
# 2. Reference in workflow: ${{ secrets.DATABASE_URL }}
# 3. NEVER set ALLOW_UNSAFE_TEST_DB in CI

# For Neon in CI:
# 1. Use Neon API to create a branch for each PR/commit
# 2. Set DATABASE_URL to branch connection string
# 3. Delete branch after tests complete

# ============================================================================
# EXAMPLE: Neon Branch for CI
# ============================================================================
# DATABASE_URL="postgresql://neondb_owner:***@ep-xxx-pooler.region.aws.neon.tech/neondb_test?sslmode=require"
