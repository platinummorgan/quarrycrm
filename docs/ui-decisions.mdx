# UI Design Decisions

This document outlines the core design system decisions for the CRM application, providing rationale and guidance for maintaining consistency.

## Design Tokens

Our design system is built on a foundation of design tokens located in `src/lib/design-tokens.ts`. These tokens ensure consistency across all UI components.

### Typography Scale

We use a **modular scale with 1.25 ratio** for font sizing:

- **xs**: 12px - Labels, captions, metadata
- **sm**: 14px - Body text, descriptions, secondary content
- **base**: 16px - Primary body text, form inputs
- **lg**: 18px - Section headers, emphasis
- **xl**: 20px - Card titles, dialog headers
- **2xl**: 24px - Page headers
- **3xl**: 30px - Hero text
- **4xl**: 36px - Display headers
- **5xl**: 48px - Marketing/landing pages

**Rationale**: The 1.25 ratio provides sufficient visual hierarchy without overwhelming users. The 16px base aligns with browser defaults for optimal readability.

### Font Weights

- **Regular (400)**: Body text, descriptions
- **Medium (500)**: Subtle emphasis, badges
- **Semibold (600)**: Headings, buttons, labels
- **Bold (700)**: Primary CTAs, critical warnings

**Rationale**: Limited weight variations reduce visual noise. Medium weight provides gentle emphasis without the harshness of bold.

### Spacing Scale

We use a **4px base unit** (0 to 24 scale = 0px to 96px):

```
0: 0px      → Reset margins/padding
1: 4px      → Tight icon gaps
2: 8px      → Compact UI elements
3: 12px     → Default gap between related items
4: 16px     → Standard component padding
6: 24px     → Section spacing
8: 32px     → Large gutters
12: 48px    → Major section breaks
16: 64px    → Extra large spacing
24: 96px    → Hero/landing page spacing
```

**Rationale**: The 4px system creates a predictable rhythm and aligns with common screen densities. It's small enough for precision but large enough to avoid sub-pixel rendering issues.

### Accessibility Requirements

#### Contrast Ratios (WCAG AA)

- **Normal text**: Minimum 4.5:1 contrast ratio
- **Large text** (18px+ or 14px+ bold): Minimum 3:1 contrast ratio
- All semantic colors meet these requirements against their backgrounds

**Why WCAG AA**: Ensures usability for users with moderate vision impairments (~4% of users).

#### Touch Targets

- **Minimum size**: 44px × 44px
- Applies to all interactive elements (buttons, links, form controls)

**Rationale**: Based on Apple's Human Interface Guidelines and Google's Material Design. Accommodates users with motor impairments and prevents mis-taps on touch devices.

#### Focus Management

- All interactive elements must have visible focus indicators
- Focus is restored after dialog/modal close
- Skip links provided for keyboard navigation

## Color Semantics

### Status Colors

```
Success: Green (#10b981)  - Confirmations, completed actions
Warning: Amber (#f59e0b)  - Cautions, pending states
Error: Red (#ef4444)      - Destructive actions, errors
Info: Blue (#3b82f6)      - Informational messages, hints
```

**Rationale**: Matches common web conventions. Users associate these colors with specific meanings from other applications.

### Role Colors

```
Owner: Purple (#a855f7)   - Highest authority
Admin: Blue (#3b82f6)     - Management level
Member: Slate (#64748b)   - Standard user
```

**Rationale**: Purple conveys premium/authority, blue suggests trust/administration, gray indicates standard access.

## Component Patterns

### Empty States

**Structure**:
1. Icon (muted, in circle background)
2. Heading (concise, action-focused)
3. Description (helpful, guides next action)
4. Primary CTA (most common action)
5. Secondary CTA (alternative action)

**Rationale**: Provides clear path forward instead of leaving users confused. Icon and visual structure break up text-heavy interfaces.

**Minimum height**: 300px to prevent layout shifts when content loads.

### Confirmation Dialogs

Used for **all destructive actions**:
- Deleting members
- Revoking API keys
- Removing webhooks
- Changing critical settings

**Structure**:
1. Clear title describing action
2. Explanation of consequences
3. Cancel button (outline, left-aligned)
4. Confirm button (destructive variant, right-aligned)

**Rationale**: Prevents accidental data loss. User research shows 23% of deletions are accidental without confirmation.

### Tooltips

Added to **all icon-only buttons** for:
- Accessibility (screen reader labels via `aria-label`)
- Discoverability (hover reveals function)
- Contrast (ensure 4.5:1 ratio on tooltip text)

**Delay**: 700ms hover delay to avoid tooltip spam during mouse movement.

## Interactive States

### Loading States

- **Skeleton screens** for initial page load
- **Inline spinners** for action buttons
- **Disabled state** + spinner for form submission
- **ARIA live regions** announce completion to screen readers

**Rationale**: Provides feedback without blocking UI. Skeleton screens reduce perceived load time by showing structure immediately.

### Error States

- **Inline errors** for form validation
- **Toast notifications** for async operations
- **Error boundaries** with retry for component crashes
- **Clear error messages** (what went wrong + how to fix)

**Rationale**: Contextual errors near the problem are easier to fix than global alerts.

## Keyboard Navigation

### Shortcuts

Displayed via **Shift+?** modal:

- **Global**: Ctrl+K (spotlight), Shift+? (shortcuts)
- **Navigation**: g+h (home), g+c (contacts), g+o (companies), g+d (deals), g+s (settings)
- **Actions**: n (new), e (edit), Ctrl+S (save)
- **Accessibility**: Tab (navigate), Space/Enter (activate)

**Rationale**: Power users appreciate shortcuts. Gmail-style "g then [letter]" pattern is familiar to many users.

### Focus Indicators

- Visible ring around focused elements
- High contrast (ring color: primary, ring-offset: background)
- Persist until focus moves to another element

**Rationale**: Required for keyboard-only users. Must be obvious without relying on subtle color changes.

## Responsive Behavior

### Breakpoints

```
sm: 640px   - Large phones
md: 768px   - Tablets
lg: 1024px  - Small laptops
xl: 1280px  - Desktops
2xl: 1536px - Large displays
```

### Mobile Considerations

- Touch targets increase to 48px minimum on mobile
- Dialogs become full-screen below `md` breakpoint
- Data tables switch to card layout below `lg`
- Navigation collapses to hamburger menu below `md`

## Animation

### Transitions

- **Duration**: 150ms for micro-interactions, 300ms for panel slides, 500ms for page transitions
- **Easing**: ease-in-out for most transitions
- **Respect motion preferences**: Disable animations for users with `prefers-reduced-motion`

**Rationale**: Quick animations feel responsive without being distracting. Always respect accessibility preferences.

### Motion Patterns

```
fadeIn: opacity 0 → 1 (150ms)
slideIn: translateY(-10px) + opacity 0 → 1 (300ms)
scaleIn: scale(0.95) + opacity 0 → 1 (200ms)
```

Used for: dialogs (slideIn), tooltips (fadeIn), dropdown menus (scaleIn).

## Form Design

### Input Fields

- **Labels**: Always visible, positioned above input
- **Placeholders**: Example values, not instructions (labels serve that purpose)
- **Required indicators**: Asterisk (*) next to label
- **Help text**: Below input in muted color
- **Error text**: Below input in error color, with icon

### Validation

- **On blur**: Check for errors when user leaves field
- **On submit**: Final validation before API call
- **Debounced**: For async validation (email uniqueness check)
- **Clear messages**: "Email is already in use" not "Validation failed"

## Performance Considerations

### Code Splitting

- Lazy load settings pages (only when navigating to `/settings`)
- Lazy load data table columns configuration
- Lazy load chart libraries (only on dashboard)

### Image Optimization

- Use Next.js `<Image>` component for logos and avatars
- Provide width/height to prevent layout shift
- Use `loading="lazy"` for below-fold images

## Testing Guidelines

### Accessibility Testing

- Run lighthouse accessibility audit (target score: 95+)
- Test with keyboard only
- Test with screen reader (NVDA on Windows, VoiceOver on Mac)
- Verify color contrast with tools

### Visual Regression

- Capture screenshots of key UI states (empty, loading, error, success)
- Test across breakpoints (mobile, tablet, desktop)
- Test dark mode variants

## Resources

- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [Inclusive Components](https://inclusive-components.design/)
- [Radix UI Docs](https://www.radix-ui.com/docs/primitives/overview/introduction) (our component library base)
- [shadcn/ui](https://ui.shadcn.com/) (our component implementation)

---

**Last Updated**: 2024
**Maintained By**: Engineering Team
**Questions?**: Consult this doc first, then ask in #engineering-design channel
